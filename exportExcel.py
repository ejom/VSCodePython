import numpy as np
import pandas as pd
import openpyxl

#strip everything outside of <b> tags and store in list
def findBodies(bulk:str):
    bulk = bulk.replace("<", ">")
    elements = bulk.split(">") 
    numElements = []
    for element in elements:
        if element.isnumeric() or element.replace('.', '').isnumeric():
            numElements.append(element)
    return numElements

    #return elements

stuff = """<tbody><tr span="2" style="width:48pt" width="64"><th colspan="1" rowspan="1" style="text-align:center;font-weight:normal;border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" id="EAT_1522369570021_1_9225186808095962">Bar</th><th colspan="1" rowspan="1" style="text-align:center;font-weight:normal;border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" id="EAT_1522369570021_1_7494724731437372">Weight<br>(g)</th></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">1</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">74</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">2</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">82</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">3</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">97</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">4</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">86</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">5</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">71</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">6</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">68</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">7</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">83</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">8</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">90</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">9</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">88</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">10</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">64</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">11</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">99</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">12</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">75</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">13</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">77</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">14</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">82</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">15</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">93</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">16</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">70</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">17</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">87</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">18</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">76</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">19</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">84</td></tr><tr><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_9225186808095962">20</td><td colspan="1" rowspan="1" style="border-top-style: solid; border-top-width: 1px; border-right-style: solid; border-right-width: 1px; border-left-style: solid; border-left-width: 1px; border-bottom-style: solid; border-bottom-width: 1px;" align="center" headers="EAT_1522369570021_1_7494724731437372">94</td></tr></tbody>"""

#cut out unwanted numbers
nList = findBodies(stuff)
print(nList)

nArr = np.array(nList)

#change paramaters based on table of data
cols = 2
rows = 20

#what excel file to save to
excelFile = pd.ExcelWriter("Wiley2-10.xlsx")

nArr = nArr.reshape(rows, cols)
nTable = pd.DataFrame(nArr)
print(nTable)
nTable.to_excel(excelFile)
excelFile.close()
